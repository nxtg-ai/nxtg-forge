# NXTG-Forge Customization Guide

Advanced configuration for power users (the 1%)

## Philosophy

**90% of users will never read this document.** That's the goal.

NXTG-Forge is designed to work perfectly out-of-the-box with zero configuration. This guide is for the 1% who want deeper control.

## Configuration Hierarchy

### Level 0: No Configuration (Recommended)

```bash
# Just use it
forge init
claude
```

Forge analyzes your project and uses smart defaults. No config file is created until actually needed.

### Level 1: Auto-Generated Config

On first use, forge creates `.claude/forge/config.yml`:

```yaml
# Auto-generated by nxtg-forge
# Safe to edit - your changes won't be overwritten

auto_generated: true
protocol_version: "1.0"
forge_version: "1.0.0"

project_analysis:
  languages:
    - python
  frameworks:
    - fastapi
  databases:
    - postgresql

defaults:
  memory:
    enabled: true
    persistence: session  # or 'permanent'

  agents:
    orchestration: true
    max_parallel: 3

  features:
    tdd_workflow: true
    refactoring_bot: true
    analytics: true
```

### Level 2: Manual Override

Edit the config to customize behavior:

```yaml
# Disable auto-generation to prevent overwrites
auto_generated: false

preferences:
  memory:
    persistence: permanent  # Keep across sessions
    retention_days: 30      # Archive after 30 days

  agents:
    orchestration: true
    max_parallel: 5         # More parallel agents
    custom_path: ./my-custom-agents/

  features:
    tdd_workflow: true
    refactoring_bot: false  # Disable refactoring suggestions
    analytics: true

  quality:
    min_test_coverage: 90   # Require 90% coverage
    require_type_hints: true
    enforce_docstrings: true
```

## Custom Agents

### Creating Custom Agents

1. Create agent directory:

```bash
mkdir -p .claude/forge/agents/my-agent
```

2. Create agent definition:

```yaml
# .claude/forge/agents/my-agent/agent.yml
name: my-custom-agent
description: Handles my specific domain logic
version: "1.0.0"

capabilities:
  - domain-modeling
  - api-design
  - validation

triggers:
  - "design*"
  - "model*"
  - "validate*"

tools:
  - glob
  - grep
  - read
  - edit

prompts:
  system: |
    You are a domain modeling expert specializing in...

  task_prefix: |
    When analyzing domain requirements, always...
```

3. Update config to use it:

```yaml
preferences:
  agents:
    custom_path: .claude/forge/agents/
    enabled:
      - nxtg-architect  # Built-in
      - my-custom-agent # Custom
```

### Agent Priority

Agents are selected based on:

1. **Explicit mention** - "use @my-custom-agent"
2. **Trigger keywords** - Keywords in user request
3. **Domain analysis** - Project type and context
4. **Fallback** - Default to nxtg-architect

## Memory Configuration

### Session vs Permanent Memory

**Session Memory (default)**:

- Persists during active session
- Cleared when project context changes
- Good for most use cases

**Permanent Memory**:

- Persists across sessions
- Survives project switches
- Better for long-running projects

```yaml
memory:
  persistence: permanent
  retention_days: 90  # Archive after 90 days
  max_size_mb: 100    # Limit memory size
```

### Memory Cleanup

```bash
# View memory status
forge memory status

# Clear old sessions
forge memory cleanup --older-than 30d

# Clear specific session
forge memory clear --session-id abc123

# Archive and compress
forge memory archive
```

## Workflow Customization

### Custom Workflows

Create workflow scripts in `.claude/workflows/`:

```bash
#!/usr/bin/env bash
# .claude/workflows/my-deploy.sh

set -euo pipefail

echo "Running my custom deployment..."

# Your custom logic
forge checkpoint "Pre-deploy"
npm run build
forge test --coverage 85
forge deploy --target production

echo "Deployment complete!"
```

Make it executable:

```bash
chmod +x .claude/workflows/my-deploy.sh
```

### Hook Customization

Override default hooks in `.claude/hooks/`:

```bash
#!/usr/bin/env bash
# .claude/hooks/pre-task.sh

set -euo pipefail

# Run before every task
echo "Pre-task hook: Validating environment..."

# Check dependencies
forge validate dependencies

# Ensure tests pass
forge test --fast

# Create automatic checkpoint
forge checkpoint "auto-$(date +%s)"
```

## Advanced Configuration

### Custom Templates

Create project templates in `.claude/forge/templates/`:

```jinja2
{# .claude/forge/templates/my-service.py.j2 #}
"""{{ service_name }} - {{ description }}"""

from typing import Optional
from fastapi import FastAPI

class {{ service_name }}:
    """{{ description }}"""

    def __init__(self):
        self.app = FastAPI()

    async def health_check(self) -> dict:
        """Health check endpoint"""
        return {"status": "healthy"}
```

Use in config:

```yaml
templates:
  custom_path: .claude/forge/templates/
  enabled:
    - my-service
```

### Performance Tuning

```yaml
performance:
  cache:
    enabled: true
    ttl_seconds: 3600
    max_entries: 1000

  parallel:
    max_workers: 8
    timeout_seconds: 300

  analysis:
    deep_scan: false      # Faster startup
    incremental: true     # Only scan changes
```

### Integration Settings

```yaml
integrations:
  mcp:
    auto_detect: true
    configure_on_init: true

  git:
    auto_commit: false
    commit_message_template: |
      feat: {{ description }}

      {{ details }}

      Generated with NXTG-Forge

  docker:
    auto_build: false
    registry: ghcr.io/myorg
```

## Environment-Specific Configuration

### Multi-Environment Setup

```yaml
# .claude/forge/config.yml
environments:
  development:
    features:
      tdd_workflow: true
      analytics: false

  staging:
    features:
      tdd_workflow: true
      analytics: true

  production:
    features:
      tdd_workflow: false
      analytics: true
    quality:
      min_test_coverage: 95
      require_type_hints: true
```

Activate environment:

```bash
export FORGE_ENV=production
claude
```

## Debugging & Diagnostics

### Enable Debug Mode

```yaml
debug:
  enabled: true
  log_level: DEBUG
  log_file: .claude/forge/debug.log
  trace_requests: true
```

### Diagnostic Commands

```bash
# Full system check
forge doctor

# Show current configuration
forge config show

# Validate configuration
forge config validate

# Reset to defaults
forge config reset

# Show what would happen (dry run)
forge --dry-run status
```

## Migration

### Upgrading Configuration

When forge version updates:

```bash
# Check for config updates
forge config check-updates

# Migrate to new format
forge config migrate

# Show differences
forge config diff
```

### Backup and Restore

```bash
# Backup configuration
forge config backup

# Restore from backup
forge config restore --backup config-2026-01-07.yml

# Export to share with team
forge config export > team-config.yml

# Import team config
forge config import team-config.yml
```

## Best Practices

### Do's

- Start with defaults, customize only when needed
- Document why you changed defaults
- Test configuration changes in dev first
- Version control your config
- Share team configs via git

### Don'ts

- Don't disable error handling
- Don't set max_parallel too high (>8)
- Don't disable TDD workflow in production
- Don't commit secrets in config
- Don't override critical safety features

## Common Customizations

### 1. Increase Test Coverage Requirements

```yaml
quality:
  min_test_coverage: 95  # Default is 85
```

### 2. Enable Permanent Memory

```yaml
memory:
  persistence: permanent
  retention_days: 90
```

### 3. Add Custom Agent

```yaml
agents:
  custom_path: .claude/forge/agents/
  enabled:
    - nxtg-architect
    - my-domain-expert
```

### 4. Customize Commit Messages

```yaml
git:
  commit_message_template: |
    {{ type }}: {{ description }}

    {{ details }}

    Refs: #{{ issue_number }}
```

### 5. Disable Specific Features

```yaml
features:
  refactoring_bot: false  # Stop auto-suggestions
  analytics: false        # Disable tracking
```

## Getting Help

If you're customizing forge and run into issues:

1. **Check validation**: `forge config validate`
2. **View current config**: `forge config show`
3. **Reset to defaults**: `forge config reset`
4. **Check documentation**: This file
5. **Ask for help**: [GitHub Discussions](https://github.com/nxtg-ai/nxtg-forge/discussions)

## Remember

**If you're reading this, you're in the 1%.** Most users never need customization.

The fact that you can customize doesn't mean you should. Start with defaults and only customize when you have a specific need.

---

**Made with NXTG-Forge**
